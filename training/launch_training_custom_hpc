#!/bin/bash
accelerate launch $WORK/cxr_phrase_grounding/training/train.py \
--pretrained_model_name_or_path=$WORK/cxr_phrase_grounding/components \
--gradient_accumulation_steps=2 \
--max_train_steps=30001 \
--learning_rate=5e-05 \
--max_grad_norm=1 \
--lr_scheduler="cosine" \
--output_dir=$WORK/cxr_phrase_grounding/finetune/normal/radbert \
--report_to=wandb \
--checkpointing_steps=1000 \
--validation_epochs=100 \
--seed=4200 \
--config=$WORK/cxr_phrase_grounding/configs/config_msxcr_hpc.yml \
--validation_prompt="An image of a chest xray" \
--cache_dir=$WORK/cxr_phrase_grounding/.cache \
--generation_validation_epochs=1000 \
--train_batch_size=16 \
--resume_from_checkpoint=latest \
--lr_warmup_steps=0 \
--use_ema \
--use_custom \
--llm_name=radbert